<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Checkout - FreshRide</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<h1>Delivery Information</h1>
<div id="checkoutItems"></div>

<form id="checkoutForm" action="api/save_order.php" method="POST">
  <input type="text" id="customerName" name="customer_name" placeholder="Full Name" required>
  <input type="text" id="phone" name="customer_phone" placeholder="Phone Number" required>
  <input type="email" id="email" name="customer_email" placeholder="Email">
  <textarea id="address" name="customer_address" placeholder="Delivery Address" required></textarea>

  <!-- Hidden fields to send cart info -->
  <input type="hidden" id="productId" name="product_id">
  <input type="hidden" id="quantity" name="quantity">
  <input type="hidden" id="totalPrice" name="total_price">

  <button type="submit" class="btn btn-submit">Place Order</button>
</form>

<script src="js/checkout.js"></script>
<script>
// Instead of localStorage only, we also push to PHP
class CheckoutFormPage extends CheckoutPage {
    constructor() {
        super(); // load cart & init
        this.populateHiddenFields();
    }

    populateHiddenFields() {
        if (this.cart.length > 0) {
            // for demo: just use first cart item
            const firstItem = this.cart[0];

            document.getElementById('productId').value = firstItem.id;
            document.getElementById('quantity').value = firstItem.quantity || 1;
            
            // Calculate total price for all cart items
            let total = 0;
            this.cart.forEach(item => {
                total += (item.price * (item.quantity || 1));
            });
            document.getElementById('totalPrice').value = total;
        }
    }
}

// Initialize the page
new CheckoutFormPage();
</script>
</body>
</html>
